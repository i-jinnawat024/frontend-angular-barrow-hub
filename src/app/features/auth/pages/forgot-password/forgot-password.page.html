<section class="flex min-h-screen bg-gradient-to-br from-indigo-50 via-slate-100 to-white dark:from-slate-900 dark:via-slate-950 dark:to-slate-900">
  <div class="hidden flex-1 items-center justify-center bg-gradient-to-br from-blue-600 to-indigo-700 p-10 text-inverse lg:flex">
    <div class="max-w-lg space-y-6">
      <mat-icon class="material-symbols-outlined text-5xl text-white/80">mail_lock</mat-icon>
      <h2 class="text-4xl font-semibold">ขอรีเซ็ตรหัสผ่าน</h2>
      <p class="text-lg text-white/80">
        กรอกอีเมลที่คุณใช้ในระบบ Barrow Hub เราจะสร้างลิงก์สำหรับรีเซ็ตรหัสผ่านและส่งให้คุณทางกล่องข้อความ
      </p>
      <ul class="space-y-2 text-white/70">
        <li>• ลิงก์จะมีอายุ 24 ชั่วโมง นับจากเวลาที่สร้าง</li>
        <li>• หากไม่ได้รับอีเมลภายใน 5 นาที ให้ตรวจสอบใน Junk/Spam</li>
        <li>• ติดต่อผู้ดูแลระบบหากคุณไม่สามารถเข้าถึงอีเมลดังกล่าวได้</li>
      </ul>
    </div>
  </div>

  <div class="flex min-h-screen flex-1 items-center justify-center px-6 py-12 sm:px-10">
    <div class="w-full max-w-lg rounded-2xl border border-subtle bg-surface p-8 shadow-2xl shadow-slate-900/5">
      <button type="button" class="btn-secondary mb-3 gap-1" (click)="toLogin()">
        <mat-icon class="material-symbols-outlined text-base">arrow_back</mat-icon>
        กลับสู่หน้าเข้าสู่ระบบ
      </button>

      <div class="mb-8">
        <div class="flex items-center gap-3">
          <div class="rounded-2xl bg-blue-100 p-3 text-blue-600">
            <mat-icon class="material-symbols-outlined text-3xl">mark_email_unread</mat-icon>
          </div>
          <div>
            <h1 class="text-2xl font-semibold text-primary">ลืมรหัสผ่าน</h1>
            <p class="text-sm text-muted">สร้างคำขอรีเซ็ตรหัสผ่านใหม่</p>
          </div>
        </div>
        <p class="mt-4 text-sm text-secondary">
          ระบบลืมรหัสผ่านสร้างและทำงานครบถ้วนแล้ว แต่ยังไม่ถูกเชื่อมโยงจากหน้าอื่น หากต้องการใช้งานให้เข้ามายังลิงก์นี้โดยตรง
        </p>
      </div>

      <form class="space-y-6" [formGroup]="resetForm" (ngSubmit)="submit()">
        <div class="space-y-2">
          <label class="form-label" for="forgot-email">อีเมลที่ลงทะเบียน</label>
          <div class="relative">
            <mat-icon class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-secondary">mail</mat-icon>
            <input
              id="forgot-email"
              type="email"
              formControlName="email"
              class="form-control ps-10"
              placeholder="เช่น admin@barrowhub.local"
              autocomplete="email"
            />
          </div>
          @if (hasError('email', 'required')) {
          <p class="text-sm text-danger">กรุณากรอกอีเมล</p>
          } @else if (hasError('email', 'email')) {
          <p class="text-sm text-danger">รูปแบบอีเมลไม่ถูกต้อง</p>
          }
        </div>

        @if (status() === 'success' && response()) {
        <div class="rounded-2xl border border-success bg-success/10 px-4 py-3 text-sm text-success" role="alert">
          <div class="font-semibold">สร้างลิงก์สำเร็จ</div>
          <p>
            {{ response()!.message }} สำหรับ
            <strong>{{ response()!.email }}</strong>
          </p>
          <p class="text-xs text-muted">
            ออกเมื่อ: {{ response()!.issuedAt | date : 'dd/MM/yyyy HH:mm น.' }}
          </p>
        </div>
        } @else if (status() === 'error' && response()) {
        <div class="rounded-2xl border border-danger bg-danger/10 px-4 py-3 text-sm text-danger" role="alert">
          {{ response()!.message }}
        </div>
        }

        <button
          type="submit"
          class="btn-primary w-full justify-center py-3 text-base font-semibold"
          [disabled]="submitting()"
        >
          @if (submitting()) {
          <span class="inline-flex h-5 w-5 animate-spin rounded-full border-2 border-white/80 border-t-transparent"></span>
          กำลังสร้างลิงก์...
          } @else {
          <mat-icon class="material-symbols-outlined text-lg">mark_email_read</mat-icon>
          ส่งคำขอรีเซ็ตรหัสผ่าน
          }
        </button>
      </form>
    </div>
  </div>
</section>
